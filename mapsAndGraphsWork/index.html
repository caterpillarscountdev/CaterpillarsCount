<html>
	<head>
		<!-- Google Analytics -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=UA-113319025-1"></script>
		<script>
  			window.dataLayer = window.dataLayer || [];
  			function gtag(){dataLayer.push(arguments);}
  			gtag('js', new Date());
			gtag('config', 'UA-113319025-1');
		</script>
		<!-- End of Google Analytics -->

		<title>Maps & Graphs | Caterpillars Count!</title>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
		<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC3VugOTqs_94H5B51-xVyxBGHqx4uqxTA"></script>
		<link href="https://fonts.googleapis.com/css?family=Kaushan+Script" rel="stylesheet">
		<link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet">
		<link href="https://fonts.googleapis.com/css?family=Fanwood+Text:400i" rel="stylesheet">
		<link href="https://fonts.googleapis.com/css?family=Roboto+Slab" rel="stylesheet">
		<link href="../css/template.css" rel="stylesheet">
		<script src="../js/template.js?v=1"></script>
		<style>
			.loading{
				background:rgba(0,0,0,0.1);
				padding:20px;
				text-align:center;
				border-radius:5px;
			}
			
			.loading>img{
				height:30px;
			}
			
			#rankingsSwitch{
				color:#666;
				background:#eee;
				display:inline-block;
				border-radius:5px;
				overflow:hidden;
				border-bottom:1px solid rgba(0,0,0,0.2);
				white-space:nowrap;
				margin-bottom:20px;
				display:none;
			}
			#rankingsSwitch button{
				color:inherit;
				cursor:pointer;
				outline:none;
				margin:0px;
				border:0px none transparent;
				border-radius:0px;
				padding:7px 15px;
				font-size:14px;
				background:transparent;
				display:inline-block;
				text-align:center;
				width:70px;
			}
			
			#rankingsSwitch button:last-of-type{
				margin-left:-4px;
			}
			#rankingsSwitch .active{
				background:rgba(0,0,0,.1);
				-webkit-box-shadow: inset 2px 2px 5px 0px rgba(0,0,0,0.17);
				-moz-box-shadow: inset 2px 2px 5px 0px rgba(0,0,0,0.17);
				box-shadow: inset 2px 2px 5px 0px rgba(0,0,0,0.17);
			}
			
			#superHeader, #siteUserSuperHeader{
				background:#555;
				color:#fff;
				text-align:right;
				font-family: 'Roboto Slab', serif;
				border-radius:4px 4px 0px 0px;
				overflow:hidden;
				display:none;
			}
			#superHeader>div, #siteUserSuperHeader>div{
				padding:5px 7px;
				background:#444;
				width:60%;
				display:inline-block;
				box-sizing:border-box;
				margin-right:13%;
				text-align:center;
				text-transform:uppercase;
			}
			
			#rankings table, #siteStats table, #siteUserLeaderboard table{
				width:100%;
				border-collapse:collapse;
				font-family: 'Roboto Slab', serif;
				color:#666;
			}
			
			#siteStats table:first-of-type{
				border-radius:4px;
				overflow:hidden;
			}
			
			#rankings table thead, #siteStats table thead, #siteUserLeaderboard table thead{
				background:#666;
				color:#fff;
			}
			
			#siteStats td{
				text-align:center;
				background:rgba(0,0,0,0.025);
			}
			
			#rankings table tr td>div, #siteUserLeaderboard table tr td>div{
				max-height:500px;
				position:relative;
				min-width:100%;
			}
			
			#rankings table tr:nth-of-type(even), #siteUserLeaderboard table tr:nth-of-type(even){
				background:rgba(0,0,0,0.025);
			}
			
			#rankings table td, #rankings table th, #siteUserLeaderboard table td, #siteUserLeaderboard table th{
				width:15%;
				box-sizing:border-box;
				text-align:left;
			}
			
			#rankings table th, #siteUserLeaderboard table th{
				padding:5px 7px;
				cursor:pointer;
			}
			#rankings table th:first-of-type, #siteUserLeaderboard table th:first-of-type{
				cursor:default;
			}
			#siteStats table:first-of-type th{
				cursor:pointer;
			}
			
			#rankings table th:hover, #siteUserLeaderboard table th:hover{
				text-decoration:underline;
			}
			
			#rankings table td, #siteStats table td, #siteStats table th, #siteUserLeaderboard table td{
				padding:5px 7px;
			}
			
			#rankings table td:nth-of-type(1), #rankings table th:nth-of-type(1), #siteUserLeaderboard table td:nth-of-type(1), #siteUserLeaderboard table th:nth-of-type(1){
				width:5%;
			}
			
			#rankings table td:nth-of-type(2), #rankings table th:nth-of-type(2), #siteUserLeaderboard table td:nth-of-type(2), #siteUserLeaderboard table th:nth-of-type(2){
				width:22%;
			}
			
			#rankings table th:nth-of-type(3), #rankings table th:nth-of-type(4), #rankings table th:nth-of-type(5), #rankings table th:nth-of-type(6), #siteUserLeaderboard table th:nth-of-type(3), #siteUserLeaderboard table th:nth-of-type(4), #siteUserLeaderboard table th:nth-of-type(5), #siteUserLeaderboard table th:nth-of-type(6){
				text-align:right;
				background:rgba(0,0,0,0.1);
			}
			#rankings table td:nth-of-type(3), #rankings table td:nth-of-type(4), #rankings table td:nth-of-type(5), #rankings table td:nth-of-type(6), #siteUserLeaderboard table td:nth-of-type(3), #siteUserLeaderboard table td:nth-of-type(4), #siteUserLeaderboard table td:nth-of-type(5), #siteUserLeaderboard table td:nth-of-type(6){
				text-align:right;
				background:rgba(0,0,0,0.0315);
			}
			
			#rankings table td:last-of-type, #rankings table th:last-of-type, #siteUserLeaderboard table td:last-of-type, #siteUserLeaderboard table th:last-of-type{
				text-align:right;
				width:13%;
			}
			
			#rankings table td>div, #siteUserLeaderboard table td>div{
				display:inline-block;
			}
			
			#rankings table tr:nth-of-type(10) ~ tr td, #siteUserLeaderboard table tr:nth-of-type(10) ~ tr td{
				padding:0px 7px;
			}
			
			#rankings table tr:nth-of-type(10) ~ tr td>div, #siteUserLeaderboard table tr:nth-of-type(10) ~ tr td>div{
				max-height:0px;
				overflow:hidden;
			}
			
			#showMoreRankings, #showMoreSiteUserRankings{
				display:none;
				font-family: 'Roboto Slab', serif;
				text-align:center;
				margin-top:20px;
				color:#777;
				text-transform:uppercase;
				font-size:12px;
			}
			
			#showMoreRankings>div, #showMoreSiteUserRankings>div{
				display:inline-block;
				cursor:pointer;
				padding:5px;
				text-decoration:underline;
			}
			
			table td:first-of-type .bottomTooltip{
				left:0px;
				margin-left:0px;
			}
			
			table td:first-of-type .bottomTooltip .arrow{
				margin:-12px 0px 0px 0px;
			}
			
			.bottomTooltip{
				display:none;
				position:absolute;
				top:100%;
				margin-top:10px;
				right:0px;
				width:180px;
				font-size:13px;
				padding:5px;
				border-radius:4px;
				background:#444;
				color:#fff;
				box-sizing:border-box;
				z-index:1;
				text-align:left;
			}
			
			.bottomTooltip .arrow{
				position:relative;
				right:0px;
				margin:-12px 0px 0px 153px;
				border:5px solid transparent;
				border-top:0px none transparent;
				border-bottom:7px solid #444;
				width:0px;
			}
			#selectedSitePanel .bottomTooltip{
				text-align:center;
			}
			#selectedSitePanel .bottomTooltip .arrow{
				position:absolute;
				right:30px;
				margin:0px;
				top:-7px;
			}
			
			#rankings .underText, #siteUserLeaderboard .underText{
				color:rgba(0,0,0,0.4);
				font-size:12px;
			}
			
			#rankings .underText::after, #siteUserLeaderboard .underText::after{
				content:" survey date(s)";
			}
			
			#map{
				width:100%;
				height:92%;
				position:absolute;
				left:0px;
				right:0px;
			}
			
			#nameMaskNotice{
				font-size:10px;
				display:none;
				margin-top:-10px;
				margin-bottom:10px;
			}
			
			#selectedSitePanel{
				display:none;
			}
			
			.forceWrapIfNeeded{
				word-wrap: break-word;
			}
			
			#lastSurveyed{
				font-size:14px;
				color:#999;
				font-family: 'Roboto Slab', serif;
				text-align:center;
				margin-top:-30px;
				margin-bottom:40px;
			}
			
			#selectedSitePanel h3:first-of-type{
				margin-top:0px;
			}
			
			#noDataSection{
				text-align:center;
			}
			
			#noDataSection p{
				padding:10px;
				background:rgba(0,0,0,0.05);
				border-radius:4px;
				display:inline-block;
			}
			
			#mobileSiteStats{
				display:none;
				background:rgba(0,0,0,0.02);
				padding:10px;
				border-radius:4px;
			}
			#mobileSiteStats>ul{
				background:transparent;
				padding-left:21px;
			}
			
			#mapBar{
				padding:10px;
				background:rgba(0,0,0,0.05);
				margin:0px -100px;
			}
			
			#mapFiltersToggleButton{
				width:30px;
				height:30px;
				border-radius:5px;
				background:#fff;
				background-image:url('../images/filterIcon.png');
				background-size:contain;
				background-position:center;
				background-repeat:no-repeat;
			}
			
			@media screen and (max-width: 600px){
				#desktopSiteStats{
					display:none;
				}
				#mobileSiteStats{
					display:block;
				}
			}
			
			@media screen and (max-width: 957px){
				#rankings table tr td:nth-of-type(5), #rankings table thead th:nth-of-type(5), #siteUserLeaderboard table tr td:nth-of-type(5), #siteUserLeaderboard table thead th:nth-of-type(5){
					display:none;
				}
			}
			
			@media screen and (max-width: 868px){
				#rankings table tr td:nth-of-type(3), #rankings table thead th:nth-of-type(3), #siteUserLeaderboard table tr td:nth-of-type(3), #siteUserLeaderboard table thead th:nth-of-type(3){
					display:none;
				}
			}
			
			@media screen and (max-width: 783px){
				#rankings table tr td:nth-of-type(4), #rankings table thead th:nth-of-type(4), #siteUserLeaderboard table tr td:nth-of-type(4), #siteUserLeaderboard table thead th:nth-of-type(4){
					display:none;
				}
			}
			
			@media screen and (max-width: 539px){
				#rankings table tr td:nth-of-type(6), #rankings table thead th:nth-of-type(6), #siteUserLeaderboard table tr td:nth-of-type(6), #siteUserLeaderboard table thead th:nth-of-type(6){
					display:none;
				}
				
				#rankings table td:nth-of-type(2), #rankings table th:nth-of-type(2), #siteUserLeaderboard table td:nth-of-type(2), #siteUserLeaderboard table th:nth-of-type(2){
					width:auto;
					min-width:0px;
				}
			}
			
			@media screen and (max-width: 373px){
				main h2{
					font-size:33px;
				}
			}
			
			@media screen and (max-width: 770px){
				#mapBar{
					margin:0px -20px;
				}
			}
		</style>
		<script>
			$(document).ready(function(){
				loadBackgroundImage($("#splashImage"), "../images/splash.png");
				showLeaderboard();
				initializeMap();
				lockInMapHeight();
				$(window).resize(function(){
					lockInMapHeight();
					resizeSuperHeader();
				});
			});
			function getOrdinal(e){n=e.toString();for(var t="",h=0,d=n.length-1;d>=0;d--)if(1==++h)"0"==n[d]||("1"==n[d]?t="first":"2"==n[d]?t="second":"3"==n[d]?t="third":"4"==n[d]?t="fourth":"5"==n[d]?t="fifth":"6"==n[d]?t="sixth":"7"==n[d]?t="seventh":"8"==n[d]?t="eighth":"9"==n[d]&&(t="ninth"));else if(2==h)"0"==n[d]||("1"==n[d]?"0"==n[d+1]?t="tenth":"1"==n[d+1]?t="eleventh":"2"==n[d+1]?t="twelfth":"3"==n[d+1]?t="thirteenth":"4"==n[d+1]?t="fourteenth":"5"==n[d+1]?t="fifteenth":"6"==n[d+1]?t="sixteenth":"7"==n[d+1]?t="seventeenth":"8"==n[d+1]?t="eighteenth":"9"==n[d+1]&&(t="nineteenth"):"2"==n[d]?t=""==t?"twentieth":"twenty-"+t:"3"==n[d]?t=""==t?"thirtieth":"thirty-"+t:"4"==n[d]?t=""==t?"fortieth":"forty-"+t:"5"==n[d]?t=""==t?"fiftieth":"fifty-"+t:"6"==n[d]?t=""==t?"sixtieth":"sixty-"+t:"7"==n[d]?t=""==t?"seventieth":"seventy-"+t:"8"==n[d]?t=""==t?"eightieth":"eighty-"+t:"9"==n[d]&&(t=""==t?"ninetieth":"ninety-"+t));else if(3==h)"0"==n[d]||("1"==n[d]?t=""==t?"one hundredth":"one hundred and "+t:"2"==n[d]?t=""==t?"two hundredth":"two hundred and "+t:"3"==n[d]?t=""==t?"three hundredth":"three hundred and "+t:"4"==n[d]?t=""==t?"four hundredth":"four hundred and "+t:"5"==n[d]?t=""==t?"five hundredth":"five hundred and "+t:"6"==n[d]?t=""==t?"six hundredth":"six hundred and "+t:"7"==n[d]?t=""==t?"seven hundredth":"seven hundred and "+t:"8"==n[d]?t=""==t?"eight hundredth":"eight hundred and "+t:"9"==n[d]&&(t=""==t?"nine hundredth":"nine hundred and "+t));else if(4==h)return n;return t}
			function getReadableDate(databaseFormattedDate){
				//PRE: databaseFormattedDate format is YYYY-MM-DD
				var months = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
				//var months = ["Jan.", "Feb.", "March", "April", "May", "June", "July", "Aug.", "Sept.", "Oct.", "Nov.", "Dec."];
				var year = databaseFormattedDate.substring(0, 4);
				var month = months[Number(databaseFormattedDate.substring(5, 7)) - 1];
				var fullOrdinal = getOrdinal(Number(databaseFormattedDate.substring(8)));
				var day = Number(databaseFormattedDate.substring(8)) + fullOrdinal.substring(fullOrdinal.length - 2);
				return month + " " + day + ", " + year;
			}
			function getTwelveHourTime(militaryTime){
				//PRE: militaryTime format is HH:MM:SS
				var hours = Number(militaryTime.substring(0, 2));
				var minutes = militaryTime.substring(3, 5);
				var formattedHours = hours;
				if(hours == 0){formattedHours = 12;}
				else if(hours > 12){formattedHours = hours - 12;}
				var ampm = "am";
				if(hours >= 12){ampm = "pm";}
				return formattedHours + ":" + minutes + ampm;
			}
			
			function resizeSuperHeader(){
				if($("#rankings th").length > 0){
					var superHeaderWidth = $("#rankings th").eq(2)[0].clientWidth + $("#rankings th").eq(3)[0].clientWidth + $("#rankings th").eq(4)[0].clientWidth + $("#rankings th").eq(5)[0].clientWidth;
					if(superHeaderWidth == 0){
						$("#superHeader")[0].style.display = "none";
					}
					else{
						$("#superHeader")[0].style.display = "block";
						$("#superHeader>div").eq(0)[0].style.width = superHeaderWidth;
						$("#superHeader>div").eq(0)[0].style.marginRight = $("#rankings th").eq(6)[0].clientWidth;
					}
				}
				if($("#siteUserLeaderboard th").length > 0){
					var superHeaderWidth = $("#siteUserLeaderboard th").eq(2)[0].clientWidth + $("#siteUserLeaderboard th").eq(3)[0].clientWidth + $("#siteUserLeaderboard th").eq(4)[0].clientWidth + $("#siteUserLeaderboard th").eq(5)[0].clientWidth;
					if(superHeaderWidth == 0){
						$("#siteUserSuperHeader")[0].style.display = "none";
					}
					else{
						$("#siteUserSuperHeader")[0].style.display = "block";
						$("#siteUserSuperHeader>div").eq(0)[0].style.width = superHeaderWidth;
						$("#siteUserSuperHeader>div").eq(0)[0].style.marginRight = $("#siteUserLeaderboard th").eq(6)[0].clientWidth;
					}
				}
			}
			
			var map;
			var lastMarker = null;
			function activate(marker){
				marker.setIcon({
					path: google.maps.SymbolPath.CIRCLE,
					scale: marker.icon.scale,
					strokeWeight: marker.icon.strokeWeight,
					defaultFillColor: marker.icon.defaultFillColor,
					fillColor: "#fed136",
					fillOpacity: marker.icon.fillOpacity
				});
				marker.setAnimation(google.maps.Animation.BOUNCE);
				setTimeout(function(){marker.setAnimation(null);}, 750);
			}
			function deactivate(marker){
				marker.setIcon({
					path: google.maps.SymbolPath.CIRCLE,
					scale: marker.icon.scale,
					strokeWeight: marker.icon.strokeWeight,
					defaultFillColor: marker.icon.defaultFillColor,
					fillColor: marker.icon.defaultFillColor,
					fillOpacity: marker.icon.fillOpacity
				});
			}
			function toggleMarker(marker){
				if(lastMarker !== null){
					lastMarker.setZIndex();
				}
				if(marker.icon.defaultFillColor == marker.icon.fillColor){
					if(lastMarker !== null){
						deactivate(lastMarker);
					}
					activate(marker);
				}
				else{
					deactivate(marker);
				}
				lastMarker = marker;
				marker.setZIndex(google.maps.Marker.MAX_ZINDEX + 1);
			}
			function physicalMarkerClick(){
				markerClick(this);
			}
			function markerClick(marker){
				showSiteUserLeaderboard(marker.siteInformation["ID"]);
				toggleMarker(marker);
				$("#selectedSitePanel>h2")[0].innerHTML = marker.siteInformation["Name"];
				$("#selectedSitePanel>.tagline")[0].innerHTML = marker.siteInformation["Description"];
				if(marker.siteInformation["MostRecentDateTime"] == "Never"){
					$("#noDataSection")[0].style.display = "block";
					$("#dataSection")[0].style.display = "none";
				}
				else{
					$("#dataSection")[0].style.display = "block";
					$("#noDataSection")[0].style.display = "none";
					
					var dateParts = marker.siteInformation["MostRecentDateTime"].split(" ")[0].split('-');
					var lastSurveyedDate = new Date();
					lastSurveyedDate.setFullYear(Number(dateParts[0]));
					lastSurveyedDate.setMonth(Number(dateParts[1]) - 1);
					lastSurveyedDate.setDate(Number(dateParts[2]));
					var today = new Date();
					var timeDiff = Math.abs(lastSurveyedDate.getTime() - today.getTime());
					var diffDays = Math.ceil(timeDiff / (1000 * 3600 * 24));
					if(diffDays < 1){
						$("#lastSurveyed")[0].innerHTML = "Last surveyed <div onmouseenter=\"$(this).find('.bottomToolTip').stop().fadeIn(200);\" onmouseleave=\"$(this).find('.bottomToolTip').stop().fadeOut(200);\" style=\"position:relative;display:inline-block;text-decoration:underline;\">today<div class=\"bottomTooltip\">" + getReadableDate(marker.siteInformation["MostRecentDateTime"].split(" ")[0]) + ", at " + getTwelveHourTime(marker.siteInformation["MostRecentDateTime"].split(" ")[1]) + "<div class=\"arrow\"></div></div></div>.";
					}
					else if(diffDays == 1){
						$("#lastSurveyed")[0].innerHTML = "Last surveyed <div onmouseenter=\"$(this).find('.bottomToolTip').stop().fadeIn(200);\" onmouseleave=\"$(this).find('.bottomToolTip').stop().fadeOut(200);\" style=\"position:relative;display:inline-block;text-decoration:underline;\">yesterday<div class=\"bottomTooltip\">" + getReadableDate(marker.siteInformation["MostRecentDateTime"].split(" ")[0]) + ", at " + getTwelveHourTime(marker.siteInformation["MostRecentDateTime"].split(" ")[1]) + "<div class=\"arrow\"></div></div></div>.";
					}
					else{
						$("#lastSurveyed")[0].innerHTML = "Last surveyed <div onmouseenter=\"$(this).find('.bottomToolTip').stop().fadeIn(200);\" onmouseleave=\"$(this).find('.bottomToolTip').stop().fadeOut(200);\" style=\"position:relative;display:inline-block;text-decoration:underline;\">" + diffDays + " days ago<div class=\"bottomTooltip\">" + getReadableDate(marker.siteInformation["MostRecentDateTime"].split(" ")[0]) + ", at " + getTwelveHourTime(marker.siteInformation["MostRecentDateTime"].split(" ")[1]) + "<div class=\"arrow\"></div></div></div>.";
					}

					$("#siteStats")[0].innerHTML = "<table id=\"desktopSiteStats\">" + 
							"<thead>" + 
								"<tr>" + 
									"<th>Users</th>" + 
									"<th>Surveys</th>" + 
									"<th>Arthropod Groups</th>" + 
									"<th>Arthropods</th>" + 
									"<th>Caterpillars</th>" + 
								"</tr>" + 
							"</thead>" + 
							"<tr>" + 
								"<td>" + marker.siteInformation["UserCount"] + "</td>" + 
								"<td>" + marker.siteInformation["SurveyCount"] + "</td>" + 
								"<td>" + marker.siteInformation["ArthropodGroupCount"] + "</td>" + 
								"<td>" + marker.siteInformation["ArthropodCount"] + "</td>" + 
								"<td>" + marker.siteInformation["CaterpillarCount"] + "</td>" + 
							"</tr>" + 
						"</table>" + 
						"<div id=\"mobileSiteStats\">" + 
							"<ul class=\"scrollAnimationElement fadeInOnScroll\" style=\"opacity: 1;\">" + 
								"<li><span class=\"bold\">Users: </span>" + marker.siteInformation["UserCount"] + "</li>" + 
								"<li><span class=\"bold\">Surveys: </span>" + marker.siteInformation["SurveyCount"] + "</li>" + 
								"<li><span class=\"bold\">Arthropod Groups: </span>" + marker.siteInformation["ArthropodGroupCount"] + "</li>" + 
								"<li><span class=\"bold\">Arthropods: </span>" + marker.siteInformation["ArthropodCount"] + "</li>" + 
								"<li><span class=\"bold\">Caterpillars: </span>" + marker.siteInformation["CaterpillarCount"] + "</li>" + 
							"</ul>" + 
						"</div>";
				}
				$("#selectedSitePanel")[0].style.display = "block";
				scrollToPanel(3);
			}
			
			var currentSiteUserLeaderboardSiteID = -1;
			var siteUserRankings = [];
			function showSiteUserLeaderboard(siteID){
				if(siteID == currentSiteUserLeaderboardSiteID){return false;}
				currentSiteUserLeaderboardSiteID = siteID;
				
				$("#showMoreSiteUserRankings")[0].style.display = "none";
				$("#siteUserSuperHeader")[0].style.display = "none";
				$("#siteUserLeaderboard")[0].innerHTML = "<div class=\"loading\"><img src=\"../images/rolling.svg\"/></div>";
				
				$.get("../php/getUserRankings.php?siteID=" + siteID, function(data){
					//success
					if(siteID == currentSiteUserLeaderboardSiteID){
						siteUserRankings = JSON.parse(data);
						populateSiteUserLeaderboard("Year", false);
					}
				})
				.fail(function(){
					//error
					$("#siteUserLeaderboard")[0].innerHTML = "";
					queueNotice("error", "Your request did not process. You may have a weak internet connection, or our servers might be busy. Please try again.");
				})
				.always(function() {
					//complete
				});
			}
			
			var numberOfShownSiteUserRankings = 10;
			function showMoreSiteUserRankings(){
				var NUMBER_OF_COLUMNS = 7;
				numberOfShownSiteUserRankings += 10;
				var numberOfShownRankings = numberOfShownSiteUserRankings;
				$('#siteUserLeaderboard tr td>div').slice(0,numberOfShownRankings * NUMBER_OF_COLUMNS).stop().animate({maxHeight:'500px'}, 500, function(){
					$('#siteUserLeaderboard tr td>div').slice(0,numberOfShownRankings * NUMBER_OF_COLUMNS).css({overflow:'visible'});
				});
				$('#siteUserLeaderboard tr td').slice(0,numberOfShownRankings * NUMBER_OF_COLUMNS).stop().animate({padding:'5px 7px'}, 300);

				if(numberOfShownRankings >= $('#siteUserLeaderboard tr').length){
					$("#showMoreSiteUserRankings").fadeOut(200);
				}
			}
			
			function populateSiteUserLeaderboard(sortingMetric, keepCurrentNumberShown){
				var rankings = siteUserRankings.sort(function(a, b){
					a = a[sortingMetric];
					b = b[sortingMetric];

					var order = -1;
					if(sortingMetric == "Name"){
						order = 1;
						a = a.toLowerCase();
						b = b.toLowerCase();
						if(a == "(anonymous user)") return 1;
						if(b == "(anonymous user)") return -1;
					}
					else{
						if(sortingMetric == "Caterpillars"){
							a = Number(a.replace("%", ''));
							b = Number(b.replace("%", ''));
						}
						a = Number(a);
						b = Number(b);
					}
					
					if(a < b) return -1 * order;
					if(a > b) return 1 * order;
					return 0;
				});

				var htmlToAdd = 	"<table>";
				htmlToAdd += 			"<thead>";
				htmlToAdd += 				"<tr>";
				htmlToAdd +=					"<th></th>";
				htmlToAdd += 					"<th onclick=\"populateSiteUserLeaderboard('Name', true);\"";
				if(sortingMetric == "Name"){
					htmlToAdd += 				" style=\"text-decoration:underline;\"";
				}
				htmlToAdd += 					">User name</th>";
				htmlToAdd += 					"<th onclick=\"populateSiteUserLeaderboard('Week', true);\"";
				if(sortingMetric == "Week"){
					htmlToAdd += 				" style=\"text-decoration:underline;\"";
				}
				htmlToAdd += 					">Week</th>";
				htmlToAdd += 					"<th onclick=\"populateSiteUserLeaderboard('Month', true);\"";
				if(sortingMetric == "Month"){
					htmlToAdd += 				" style=\"text-decoration:underline;\"";
				}
				htmlToAdd += 					">Month</th>";
				htmlToAdd += 					"<th onclick=\"populateSiteUserLeaderboard('Year', true);\"";
				if(sortingMetric == "Year"){
					htmlToAdd += 				" style=\"text-decoration:underline;\"";
				}
				htmlToAdd += 					">Year</th>";
				htmlToAdd += 					"<th onclick=\"populateSiteUserLeaderboard('Total', true);\"";
				if(sortingMetric == "Total"){
					htmlToAdd += 				" style=\"text-decoration:underline;\"";
				}
				htmlToAdd += 					">Millennium</th>";
				htmlToAdd += 					"<th onclick=\"populateSiteUserLeaderboard('Caterpillars', true);\" onmouseenter=\"$(this).find('.bottomToolTip').stop().fadeIn(200);\" onmouseleave=\"$(this).find('.bottomToolTip').stop().fadeOut(200);\" style=\"position:relative;";
				if(sortingMetric == "Caterpillars"){
					htmlToAdd += 				"text-decoration:underline;";
				}
				htmlToAdd += 					"\">Caterpillars<div class=\"bottomToolTip\"><div class=\"arrow\"></div>Proportion of surveys that have caterpillars</div></th>";
				htmlToAdd += 				"</tr>";
				htmlToAdd += 			"</thead>";
				for(var i = 0; i < rankings.length; i++){
					htmlToAdd += 		"<tr>";
					htmlToAdd +=			"<td><div>" + (i + 1) + "</div></td>";
					htmlToAdd += 			"<td><div id=\"" + rankings[i]["ID"] + "\">" + rankings[i]["Name"] + "</div></td>";
					htmlToAdd += 			"<td><div>" + rankings[i]["Week"] + "<div class='underText'>" + rankings[i]["UniqueDatesThisWeek"] + "</div></div></td>";
					htmlToAdd += 			"<td><div>" + rankings[i]["Month"] + "<div class='underText'>" + rankings[i]["UniqueDatesThisMonth"] + "</div></div></td>";
					htmlToAdd += 			"<td><div>" + rankings[i]["Year"] + "<div class='underText'>" + rankings[i]["UniqueDatesThisYear"] + "</div></div></td>";
					htmlToAdd += 			"<td><div>" + rankings[i]["Total"] + "<div class='underText'>" + rankings[i]["TotalUniqueDates"] + "</div></div></td>";
					htmlToAdd += 			"<td><div style=\"position:relative;\" onmouseenter=\"$(this).find('.bottomToolTip').stop().fadeIn(200);\" onmouseleave=\"$(this).find('.bottomToolTip').stop().fadeOut(200);\">" + rankings[i]["Caterpillars"] + "<div class=\"bottomToolTip\"><div class=\"arrow\"></div>Proportion of surveys that have caterpillars</div></div></td>";
					htmlToAdd += 		"</tr>";
				}
				htmlToAdd += 		"</table>";
				if(rankings.length > 10){
					$("#showMoreSiteUserRankings")[0].style.display = "block";
				}
				else{
					$("#showMoreSiteUserRankings")[0].style.display = "none";
				}
				$("#siteUserLeaderboard")[0].innerHTML = htmlToAdd;
				resizeSuperHeader();
				if(keepCurrentNumberShown){
					var NUMBER_OF_COLUMNS = 7;
					$('#siteUserLeaderboard tr td>div').slice(0,numberOfShownSiteUserRankings * NUMBER_OF_COLUMNS).stop().css({maxHeight:'500px', overflow:'visible'});
					$('#siteUserLeaderboard tr td').slice(0,numberOfShownSiteUserRankings * NUMBER_OF_COLUMNS).stop().css({padding:'5px 7px'});

					if(numberOfShownSiteUserRankings >= $('#siteUserLeaderboard tr').length){
						$("#showMoreSiteUserRankings").fadeOut(0);
					}
				}
				else{
					numberOfShownSiteUserRankings = 10;
				}
			}
			
			function hexToRgb(hex) {
				// Expand shorthand form (e.g. "03F") to full form (e.g. "0033FF")
				var shorthandRegex = /^#?([a-f\d])([a-f\d])([a-f\d])$/i;
				hex = hex.replace(shorthandRegex, function(m, r, g, b) {
					return r + r + g + g + b + b;
				});

				var result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
				return result ? [parseInt(result[1], 16), parseInt(result[2], 16), parseInt(result[3], 16)] : [0, 0, 0];
			}
			
			function mapPercentToColor(percent){
				percent = Number(percent.toString().replace("%", ""));
				//alert(percent);
				//var colors = [[247,255,0], [255,140,0], [255,0,0]];//yellow, orange, red
				//var colors = [hexToRgb("#000dff"), hexToRgb("#ff00ee")];//royalblue, hotpink
				//var colors = [hexToRgb("#000dff"), hexToRgb("#22ff00")];//royalblue, limegreen
				//var colors = [hexToRgb("#0022ff"), hexToRgb("#0dfa30"), hexToRgb("#f7ff00"), hexToRgb("#ff0000")];//blue, green, yellow, red
				var colors = [hexToRgb("#2d5227"), hexToRgb("#22ff00")];//darkgreen, limegreen
				//var colors = [hexToRgb("#000787"), hexToRgb("#ff00ff")];//midnightblue, hotpink
				for(var i = 0; i < colors.length; i++){
					if(percent == (i/(colors.length - 1))) return "rgb(" + colors[i].join(", ") + ")";
				}
				var color1, color2;
				for(var i = 1; i < colors.length; i++){
					if(percent < (i/(colors.length - 1))){
						color1 = colors[i];
						color2 = colors[i - 1];
						percent = (percent - ((i - 1) * (1/(colors.length - 1)))) / ((i/(colors.length - 1)) - ((i - 1) * (1/(colors.length - 1))));
						
					}
				}
				var w1 = ((percent * 2 - 1)/1+1) / 2;
				var w2 = 1 - w1;
				return "rgb(" + Math.round(color1[0] * w1 + color2[0] * w2) + ", " + Math.round(color1[1] * w1 + color2[1] * w2) + ", " + Math.round(color1[2] * w1 + color2[2] * w2) + ")";
			}
			
			function getNormalizedWeights(sitesArray){//data is in the form of: [{"ID": 2, "Name": "Example Site", "Data": 9999, ...etc}]
				var max = 0;
				var min = false;
				for(var i = 0; i < sitesArray.length; i++){
					var data = Number(sitesArray[i]["Weight"].toString().replace(/[^0-9.-]/g, ""));
					var isExampleSite = (Number(sitesArray[i]["ID"]) == 2);
					if(min === false && !isExampleSite){min = data;}
					if(data > max && !isExampleSite){
						max = data;
					}
					if(data < min && !isExampleSite){
						min = data;
					}
				}
				var arrToReturn = [];
				for(var i = 0; i < sitesArray.length; i++){
					var data = Number(sitesArray[i]["Weight"].toString().replace(/[^0-9.-]/g, ""));
					var minMaxedData = min;
					if(max > min){
						minMaxedData = (data - min) / (max - min);
					}
					var cappedMinMaxedData = Math.max(0, Math.min(1, minMaxedData));
					arrToReturn[arrToReturn.length] = cappedMinMaxedData;
				}
				return arrToReturn;
			}
			
			var markers = {};
			function filterMap(){
				var includeWetLeaves = true;
				var occurranceInsteadOfDensity = false;
				var monthStart = Number(1);
				var monthEnd = Number(12);
				var yearStart = Number(2018);
				var yearEnd = Number(2018);
				var arthropod = "beetle";
				var minSize = Number(0);
				var plantSpecies = "%";
				$.get("../php/getSites.php?includeWetLeaves=" + includeWetLeaves + "&occurranceInsteadOfDensity=" + occurranceInsteadOfDensity + "&monthStart=" + monthStart + "&monthEnd=" + monthEnd + "&yearStart=" + yearStart + "&yearEnd=" + yearEnd + "&arthropod=" + encodeURIComponent(arthropod) + "&minSize=" + minSize + "&plantSpecies=" + encodeURIComponent(plantSpecies), function(data){
					//success
					//clear old markers
					for (var siteID in markers) {
						if (markers.hasOwnProperty(siteID)) {
							markers[siteID].setMap(null);
						}
					}
					markers = {};
					
					//set new markers
					var sites = JSON.parse(data);
					var normalizedWeights = getNormalizedWeights(sites);
					for(var i = 0; i < sites.length; i++){
						var latlng = {lat:Number(sites[i]["Coordinates"].split(",")[0]), lng:Number(sites[i]["Coordinates"].split(",")[1])};
						var color = mapPercentToColor(normalizedWeights[i]);
						var scale = 7;
						var zIndex = Math.round(normalizedWeights[i] * 100);
						if(sites[i]["Weight"] == 0){
							scale = 5;
							color = "#bbb";
							zIndex = -1;
						}
						var marker = new google.maps.Marker({
							map: map,
							position: latlng,
							title: sites[i]["Name"],
							zIndex: zIndex,
							icon: {
								path: google.maps.SymbolPath.CIRCLE,
								scale: scale,
								strokeWeight: 1,
								defaultFillColor: color,
								fillColor: color,
								fillOpacity: .9
							},
							animation: google.maps.Animation.DROP,
							siteInformation: {
								ID: sites[i]["ID"],
								Name: sites[i]["Name"],
								Description: sites[i]["Description"],
								UserCount: sites[i]["UserCount"],
								ArthropodGroupCount: sites[i]["ArthropodGroupCount"],
								ArthropodCount: sites[i]["ArthropodCount"],
								CaterpillarCount: sites[i]["CaterpillarCount"],
								SurveyCount: sites[i]["SurveyCount"],
								MostRecentDateTime: sites[i]["MostRecentDateTime"]
							}
						});
						marker.addListener('click', physicalMarkerClick);
						markers[sites[i]["ID"] + ""] = marker;
						//marker.setMap(map);
					}
				})
				.fail(function(){
					//error
					queueNotice("error", "Your request did not process. You may have a weak internet connection, or our servers might be busy. Please try again.");
				})
				.always(function() {
					//complete
				});
			}
			function initializeMap() {
				map = new google.maps.Map($('#map')[0], {
					center: {lat: 37.068427, lng: -80.089019},
					zoom: 5
				});
				
				$.get("../php/getSites.php?includeWetLeaves=true&occurranceInsteadOfDensity=true&monthStart=1&monthEnd=12&yearStart=0&yearEnd=99999&arthropod=caterpillar&minSize=0&plantSpecies=" + encodeURIComponent("%"), function(data){
					//success
					var sites = JSON.parse(data);
					/*
					var maxCaterpillars = 0;
					var minCaterpillars = 100;
					for(var i = 0; i < sites.length; i++){
						if(Number(sites[i]["Caterpillars"].replace("%", "")) > maxCaterpillars && Number(sites["ID"]) != 2){
							maxCaterpillars = Number(sites[i]["Caterpillars"].replace("%", ""));
						}
						if(Number(sites[i]["Caterpillars"].replace("%", "")) < minCaterpillars && Number(sites["ID"]) != 2){
							minCaterpillars = Number(sites[i]["Caterpillars"].replace("%", ""));
						}
					}
					*/
					var normalizedWeights = getNormalizedWeights(sites);
					for(var i = 0; i < sites.length; i++){
						var latlng = {lat:Number(sites[i]["Coordinates"].split(",")[0]), lng:Number(sites[i]["Coordinates"].split(",")[1])};
						/*
						var caterpillars = Number(sites[i]["Caterpillars"].replace("%", ""));
						var minMaxedCaterpillars = (caterpillars - minCaterpillars) / (maxCaterpillars - minCaterpillars);
						var finalCaterpillarNumber = Math.max(0, Math.min(1, minMaxedCaterpillars));
						*/
						//var color = mapPercentToColor(finalCaterpillarNumber);
						var color = mapPercentToColor(normalizedWeights[i]);
						var scale = 7;
						var zIndex = Math.round(normalizedWeights[i] * 100);
						if(sites[i]["Weight"] == 0){
							scale = 5;
							color = "#bbb";
							zIndex = -1;
						}
						var marker = new google.maps.Marker({
							map: map,
							position: latlng,
							title: sites[i]["Name"],
							zIndex: zIndex,
							icon: {
								path: google.maps.SymbolPath.CIRCLE,
								scale: scale,
								strokeWeight: 1,
								defaultFillColor: color,
								fillColor: color,
								fillOpacity: .9
							},
							animation: google.maps.Animation.DROP,
							siteInformation: {
								ID: sites[i]["ID"],
								Name: sites[i]["Name"],
								Description: sites[i]["Description"],
								UserCount: sites[i]["UserCount"],
								ArthropodGroupCount: sites[i]["ArthropodGroupCount"],
								ArthropodCount: sites[i]["ArthropodCount"],
								CaterpillarCount: sites[i]["CaterpillarCount"],
								SurveyCount: sites[i]["SurveyCount"],
								MostRecentDateTime: sites[i]["MostRecentDateTime"]
							}
							
						});
						marker.addListener('click', physicalMarkerClick);
						markers[sites[i]["ID"] + ""] = marker;
						//marker.setMap(map);
					}
				})
				.fail(function(){
					//error
					queueNotice("error", "Your request did not process. You may have a weak internet connection, or our servers might be busy. Please try again.");
				})
				.always(function() {
					//complete
				});
			}
			function lockInMapHeight(){
				var mapHeight = (window.innerHeight|| document.documentElement.clientHeight|| document.getElementsByTagName('body')[0].clientHeight) - $("header").eq(0)[0].clientHeight;
				$("#map")[0].style.height = mapHeight + "px";
				$("#mapSpace")[0].style.height = mapHeight + "px";
			}
			
			var numberOfShownSiteRankings = 10;
			var numberOfShownUserRankings = 10;
			var siteRankings = [];
			var userRankings = [];
			var shownRankings = "Site";
			var loadedRankingsDataCount = 0;
			function showLeaderboard(){
				$.get("../php/getSiteRankings.php", function(data){
					//success
					siteRankings = JSON.parse(data);
					if(++loadedRankingsDataCount == 2){
						populateLeaderboard("Year");
					}
				})
				.fail(function(){
					//error
					$("#rankings")[0].innerHTML = "";
					queueNotice("error", "Your request did not process. You may have a weak internet connection, or our servers might be busy. Please try again.");
				})
				.always(function() {
					//complete
				});
				
				$.get("../php/getUserRankings.php", function(data){
					//success
					userRankings = JSON.parse(data);
					if(++loadedRankingsDataCount == 2){
						populateLeaderboard("Year");
					}
				})
				.fail(function(){
					//error
					$("#rankings")[0].innerHTML = "";
					queueNotice("error", "Your request did not process. You may have a weak internet connection, or our servers might be busy. Please try again.");
				})
				.always(function() {
					//complete
				});
			}
			
			var lastSiteSortingMetric = "Year";
			var lastUserSortingMetric = "Year";
			function populateLeaderboard(sortingMetric){
				if(loadedRankingsDataCount < 2){return false;}
				
				var rankings = [];
				if(shownRankings == "Site"){
					rankings = siteRankings;
					lastSiteSortingMetric = sortingMetric;
				}
				else{
					rankings = userRankings;
					lastUserSortingMetric = sortingMetric;
				}
				rankings = rankings.sort(function(a, b){
					a = a[sortingMetric];
					b = b[sortingMetric];
					
					var order = -1;
					if(sortingMetric == "Name"){
						order = 1;
						a = a.toLowerCase();
						b = b.toLowerCase();
						if(a == "(anonymous user)") return 1;
						if(b == "(anonymous user)") return -1;
					}
					else{
						if(sortingMetric == "Caterpillars"){
							a = Number(a.replace("%", ''));
							b = Number(b.replace("%", ''));
						}
						a = Number(a);
						b = Number(b);
					}
					
					if(a < b) return -1 * order;
					if(a > b) return 1 * order;
					return 0;
				});

				var htmlToAdd = 	"<table>";
				htmlToAdd += 			"<thead>";
				htmlToAdd += 				"<tr>";
				htmlToAdd +=					"<th></th>";
				htmlToAdd += 					"<th onclick=\"populateLeaderboard('Name');\"";
				if(sortingMetric == "Name"){
					htmlToAdd += 				" style=\"text-decoration:underline;\"";
				}
				htmlToAdd += 					">" + shownRankings + " name</th>";
				htmlToAdd += 					"<th onclick=\"populateLeaderboard('Week');\"";
				if(sortingMetric == "Week"){
					htmlToAdd += 				" style=\"text-decoration:underline;\"";
				}
				htmlToAdd += 					">Week</th>";
				htmlToAdd += 					"<th onclick=\"populateLeaderboard('Month');\"";
				if(sortingMetric == "Month"){
					htmlToAdd += 				" style=\"text-decoration:underline;\"";
				}
				htmlToAdd += 					">Month</th>";
				htmlToAdd += 					"<th onclick=\"populateLeaderboard('Year');\"";
				if(sortingMetric == "Year"){
					htmlToAdd += 				" style=\"text-decoration:underline;\"";
				}
				htmlToAdd += 					">Year</th>";
				htmlToAdd += 					"<th onclick=\"populateLeaderboard('Total');\"";
				if(sortingMetric == "Total"){
					htmlToAdd += 				" style=\"text-decoration:underline;\"";
				}
				htmlToAdd += 					">Millennium</th>";
				htmlToAdd += 					"<th onclick=\"populateLeaderboard('Caterpillars');\" onmouseenter=\"$(this).find('.bottomToolTip').stop().fadeIn(200);\" onmouseleave=\"$(this).find('.bottomToolTip').stop().fadeOut(200);\" style=\"position:relative;";
				if(sortingMetric == "Caterpillars"){
					htmlToAdd += 				"text-decoration:underline;";
				}
				htmlToAdd += 					"\">Caterpillars<div class=\"bottomToolTip\"><div class=\"arrow\"></div>Proportion of surveys that have caterpillars</div></th>";
				htmlToAdd += 				"</tr>";
				htmlToAdd += 			"</thead>";
				for(var i = 0; i < rankings.length; i++){
					htmlToAdd += 		"<tr>";
					htmlToAdd +=			"<td><div>" + (i + 1) + "</div></td>";
					htmlToAdd += 			"<td><div id=\"" + rankings[i]["ID"] + "\"";
					if(shownRankings == "Site"){
					   htmlToAdd += 		" onclick=\"markerClick(markers['" + rankings[i]["ID"] + "'])\" class=\"pointer underline\"";
					}
					htmlToAdd += 			">" + rankings[i]["Name"] + "</div></td>";
					htmlToAdd += 			"<td><div>" + rankings[i]["Week"] + "<div class='underText'>" + rankings[i]["UniqueDatesThisWeek"] + "</div></div></td>";
					htmlToAdd += 			"<td><div>" + rankings[i]["Month"] + "<div class='underText'>" + rankings[i]["UniqueDatesThisMonth"] + "</div></div></td>";
					htmlToAdd += 			"<td><div>" + rankings[i]["Year"] + "<div class='underText'>" + rankings[i]["UniqueDatesThisYear"] + "</div></div></td>";
					htmlToAdd += 			"<td><div>" + rankings[i]["Total"] + "<div class='underText'>" + rankings[i]["TotalUniqueDates"] + "</div></div></td>";
					htmlToAdd += 			"<td><div style=\"position:relative;\" onmouseenter=\"$(this).find('.bottomToolTip').stop().fadeIn(200);\" onmouseleave=\"$(this).find('.bottomToolTip').stop().fadeOut(200);\">" + rankings[i]["Caterpillars"] + "<div class=\"bottomToolTip\"><div class=\"arrow\"></div>Proportion of surveys that have caterpillars</div></div></td>";
					htmlToAdd += 		"</tr>";
				}
				htmlToAdd += 		"</table>";
				$("#rankings")[0].innerHTML = htmlToAdd;
				if(shownRankings == "User"){
					$("#nameMaskNotice")[0].style.display = "block";
				}
				else{
					$("#nameMaskNotice")[0].style.display = "none";
				}
				$("#showMoreRankings").stop().fadeIn(0);
				resizeSuperHeader();
				$("#rankingsSwitch").stop().css({display:"inline-block"});
				showCurrentNumberOfRankings();
			}
			
			function showMoreRankings(){
				if(shownRankings == "Site"){
					numberOfShownSiteRankings += 10;
				}
				else{
					numberOfShownUserRankings += 10;
				}
				showCurrentNumberOfRankings(true);
			}
			
			function showCurrentNumberOfRankings(showAnimation){
				showAnimation = showAnimation || false;
				var numberOfShownRankings = numberOfShownSiteRankings;
				if(shownRankings == "User"){
					numberOfShownRankings = numberOfShownUserRankings;
				}
				var NUMBER_OF_COLUMNS = 7;
				if(showAnimation){
					$('#rankings tr td>div').slice(0,numberOfShownRankings * NUMBER_OF_COLUMNS).stop().animate({maxHeight:'500px'}, 500, function(){
						$('#rankings tr td>div').slice(0,numberOfShownRankings * NUMBER_OF_COLUMNS).css({overflow:'visible'});
					});
					$('#rankings tr td').slice(0,numberOfShownRankings * NUMBER_OF_COLUMNS).stop().animate({padding:'5px 7px'}, 300);

					if(numberOfShownRankings >= $('#rankings tr').length){
						$("#showMoreRankings").fadeOut(200);
					}
				}
				else{
					$('#rankings tr td>div').slice(0,numberOfShownRankings * NUMBER_OF_COLUMNS).stop().css({maxHeight:'500px', overflow:'visible'});
					$('#rankings tr td').slice(0,numberOfShownRankings * NUMBER_OF_COLUMNS).stop().css({padding:'5px 7px'});

					if(numberOfShownRankings >= $('#rankings tr').length){
						$("#showMoreRankings").fadeOut(0);
					}
				}
			}
			
			function switchRankingsTo(leaderboardType){
				if(leaderboardType.toLowerCase() == "site"){
					shownRankings='Site';
					$("#siteSwitchButton")[0].className = "active";
					$("#userSwitchButton")[0].className = "";
					$("#siteSwitchButton")[0].innerHTML = ". . .";
					setTimeout(function(){
						populateLeaderboard(lastSiteSortingMetric);
						$("#siteSwitchButton")[0].innerHTML = "Site";
					}, 1);
				}
				else{
					shownRankings='User';
					$("#userSwitchButton")[0].className = "active";
					$("#siteSwitchButton")[0].className = "";
					$("#userSwitchButton")[0].innerHTML = ". . .";
					setTimeout(function(){
						populateLeaderboard(lastUserSortingMetric);
						$("#userSwitchButton")[0].innerHTML = "User";
					}, 1);
				}
			}
		</script>
	</head>
	<body>
		<div id="managerRequest">
			<div id="managerRequestMessage"></div>
			<div id="managerRequestButtons">
				<div class="managerRequestButton" onclick="hideNotice();respondToManagerRequest('deny');">Deny</div>
				<div class="managerRequestButton" onclick="hideNotice();respondToManagerRequest('approve');">Accept</div>
			</div>
		</div>
		<div id="error" onclick="hideNotice();"></div>
		<div id="confirmation" onclick="hideNotice();"></div>
		<div id="alert" onclick="hideNotice();"></div>
		<div id="promptInteractionBlock"></div>
		<div id="noticeInteractionBlock" onclick="hideNotice();"></div>
		<div id="confirm">
			<div></div>
			<div>
				<button>OK</button>
				<button>Cancel</button>
				<div class="clearBoth"></div>
			</div>
		</div>
		
		<div id="splash">
			<div id="splashImage"></div>
			<div id="splashOverlay">
				<div id="splashIntroText">Welcome to</div>
				<div id="splashMainText">Caterpillars Count!</div>
				<button id="splashButton" onclick="this.blur();scrollToPanel(1);">Explore maps & graphs</button>
			</div>
		</div>
		<header>
			<h1><a href="../">Caterpillars Count!</a></h1>
			<div id="hamburger" onclick="toggleNav();">
				<div></div>
				<div></div>
				<div></div>
			</div>
			<div id="navKnockDown" class="clearBoth"></div>
			<nav class="loadingNav">
				<ul>
					<li onclick="accessSubMenu(this);">
						<span>Participate</span>
						<ul onclick="event.stopPropagation();">
							<li class="closeSubmenu" onclick="closeSubmenu(this.parentNode);"><img src="../images/arrow.png"/></li>
							<li><a href="../getStarted">Get Started</a></li>
							<li><a href="../conductASurvey">Conduct a Survey</a></li>
							<li><a href="../submitObservations">Submit Observations</a></li>
							<li><a href="../hostASurveySite">Host a Survey Site</a></li>
							<li><a href="../resources">Resources</a></li>
						</ul>
					</li>
					<li onclick="accessSubMenu(this);">
						<span>Explore</span>
						<ul onclick="event.stopPropagation();">
							<li class="closeSubmenu" onclick="closeSubmenu(this.parentNode);"><img src="../images/arrow.png"/></li>
							<li><a href="../mapsAndGraphs">Maps & Graphs</a></li>
							<li><a href="../recentObservations">Recent Observations</a></li>
						</ul>
					</li>
					<li onclick="accessSubMenu(this);">
						<span>Learn</span>
						<ul onclick="event.stopPropagation();">
							<li class="closeSubmenu" onclick="closeSubmenu(this.parentNode);"><img src="../images/arrow.png"/></li>
							<li><a href="../identificationSkills">Identification Skills</a></li>
							<li><a href="../forEducators">For Educators</a></li>
							<li><a href="../faq">FAQ</a></li>
						</ul>
					</li>
					<li onclick="window.location = '../news';">
						<span>News</span>
					</li>
					<li onclick="window.location = '../signIn';">
						<span>Sign In</span>
						<ul onclick="event.stopPropagation();">
							<li class="closeSubmenu" onclick="closeSubmenu(this.parentNode);"><img src="../images/arrow.png"/></li>
							<li><a href="../createNewSite">Create New Site</a></li>
							<li><a href="../manageMySites">Manage My Sites</a></li>
							<li><a href="../manageMySurveys">Manage My Surveys</a></li>
							<li><a href="../settings">Settings</a></li>
							<li><a href="" onclick="logOut();">Sign Out</a></li>
						</ul>
					</li>
				</ul>
			</nav>
			<div id="navBack" onclick="resetMenu(false);">&#10094;</div>
		</header>
		<main>
			<div class="panel">
				<h2>Leaderboard</h2>
				<div class="content">
					<div class="centeredText">
						<div id="rankingsSwitch">
							<button id="siteSwitchButton" class="active" onclick="switchRankingsTo('site');">Site</button>
							<button id="userSwitchButton" onclick="switchRankingsTo('user');">User</button>
						</div>
					</div>
					<p id="nameMaskNotice">Visit your <a href="../settings" class="highlighted">Settings</a> page and click on "Privacy" to hide your name from these leaderboards.</p>
					<div id="rankingsRoundedTop"></div>
					<div id="superHeader">
						<div>Surveys this...</div>
					</div>
					<div id="rankings">
						<div class="loading"><img src="../images/rolling.svg"/></div>
					</div>
					<div id="showMoreRankings"><div onclick="showMoreRankings();">Show more</div></div>
				</div>
			</div>
			<div class="panel" style="padding-bottom:10px;">
				<h2>Explore Sites</h2>
				<div class="tagline">Click the sites on the map below to explore their statistics.</div>
				<div id="mapBar">
					<div id="mapFiltersToggleButton"></div>
				</div>
				<div id="map"></div>
				<div id="mapSpace"></div>
			</div>
			<div class="panel" id="selectedSitePanel">
				<h2 class="forceWrapIfNeeded"></h2>
				<div class="tagline forceWrapIfNeeded"></div>
				<div class="content">
					<div id="noDataSection">
						<div class="circleImage" style="width:200px;height:200px;background-image:url('../images/noSurveys.png');margin:40px 0px;"></div>
						<div><p>No surveys have been submitted at this site yet.</p></div>
					</div>
					<div id="dataSection">
						<div id="lastSurveyed"></div>
						<h3>Site Summary</h3>
						
						<div id="siteStats"></div>
						
						<h3>User Leaderboard</h3>
						<div id="siteUserSuperHeader">
							<div>Surveys this...</div>
						</div>
						<div id="siteUserLeaderboard"></div>
						<div id="showMoreSiteUserRankings"><div onclick="showMoreSiteUserRankings();">Show more</div></div>
						<h3>Graphs</h3>
					</div>
				</div>
			</div>
		</main>
		<footer>
			<div>Part of the <a href="http://pheno-mismatch.org" target="_blank">Pheno Mismatch</a> project funded by the National Science Foundation</div>
			
			<div><img src="../images/unc.png"/></div><div>
				<a target="_blank" href="https://www.facebook.com/Caterpillars-Count-1854259101283140/"><img src="../images/facebook.png" alt="facebook"/></a><a target="_blank" href="https://twitter.com/CaterpillarsCt"><img src="../images/twitter.png" alt="twitter"/></a>
			</div>
			
			<div>Contact us: <a href="mailto:caterpillarscount@gmail.com">caterpillarscount@gmail.com</a></div>
		
			<div>View our <a href="../privacyPolicy">privacy policy</a></div>
		</footer>
	</body>
</html>
