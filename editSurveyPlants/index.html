<html>
	<head>
		<!-- Google Analytics -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=UA-113319025-1"></script>
		<script>
  			window.dataLayer = window.dataLayer || [];
  			function gtag(){dataLayer.push(arguments);}
  			gtag('js', new Date());
			gtag('config', 'UA-113319025-1');
		</script>
		<!-- End of Google Analytics -->

		<title>Edit Survey Plants | Caterpillars Count!</title>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
		<link href="https://fonts.googleapis.com/css?family=Kaushan+Script" rel="stylesheet">
		<link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet">
		<link href="https://fonts.googleapis.com/css?family=Fanwood+Text:400i" rel="stylesheet">
		<link href="https://fonts.googleapis.com/css?family=Roboto+Slab" rel="stylesheet">
		<link href="../css/template.css" rel="stylesheet">
		<script src="../js/template.js"></script>
		<link href="../css/checkbox.css" rel="stylesheet">
		<script src="../js/checkbox.js"></script>
		<style>
			ul.ui-autocomplete{
				width:753px;
				box-sizing:border-box;
				padding:0px;
			}
			@media screen and (max-width: 999px) {
				ul.ui-autocomplete{
					width:100%;
					padding:0px 122px 0px 125px;
				}
			}
			@media screen and (max-width: 770px) {
				ul.ui-autocomplete{
					padding:0px 42px 0px 45px;
				}
			}
			ul.ui-autocomplete>li{
				background:#888;/*#a1c3ff;*/
				color:#fff;
				font-size:18px;
				padding:5px 25px;
				box-sizing:border-box;
				list-style-type:none;
			}
			
			ul.ui-autocomplete>li:last-of-type{
				border-radius:0px 0px 4px 4px;
				overflow:hidden;
				border-bottom:2px solid rgba(0,0,0,.2);
			}
			
			.ui-helper-hidden-accessible{
				display:none;
			}
			
			.ui-menu-item{
				font-size:14px;
				font-family: 'Roboto Slab', serif;
			}
			
			#saveAllButton, #addNewCircle{
				display:none;
			}
			
			.circle{
				margin:20px 0px;
				border-radius:4px;
				overflow:hidden;
				border:2px solid #eee;
			}
			
			.circleTitle{
				font-size:20px;
				background:#f7f7f7;
				color:#aaa;
				padding:20px;
				cursor:pointer;
				
			}
			.plants{
				font-size:14px;
				background:#f7f7f7;
				max-height:0px;
				overflow:hidden;
				border-right:2px solid #eee;
				border-bottom:2px solid #eee;
			}
			.circleTitle, .plants{
				font-family: 'Roboto Slab', serif;
			}
			
			.noticeImage{
				margin:4px 8px 4px 0px;
				height:18px;
				float:right;
			}
			
			.plant{
				border-left:5px solid transparent;
				padding:20px;
			}
				
			.plant:nth-of-type(1){
				border-color:#ff7575;
			}
			.plant:nth-of-type(1) .code{
				color:#ff7575;
			}
			
			.plant:nth-of-type(2){
				border-color:#75b3ff;
			}
			.plant:nth-of-type(2) .code{
				color:#75b3ff;
			}
			
			.plant:nth-of-type(3){
				border-color:#5abd61;
			}
			.plant:nth-of-type(3) .code{
				color:#5abd61;
			}
			
			.plant:nth-of-type(4){
				border-color:#ffc875;
			}
			.plant:nth-of-type(4) .code{
				color:#ffc875;
			}
			
			.plant:nth-of-type(5){
				border-color:#9175ff;
			}
			.plant:nth-of-type(5) .code{
				color:#9175ff;
			}
			.code{
				font-weight:bold;
				font-size:120%;
			}
			
			.code img{
				height:20px;
				margin-right:7px;
				margin-bottom:-3px;
			}
			
			.editableFieldTitle{
				color:#aaa;
				margin-top:10px;
			}
			
			#addNewCircle{
				margin:20px 0px;
				border-radius:4px;
				overflow:hidden;
				border:2px solid #eee;
				border-bottom:4px solid #eee;
				font-size:20px;
				background:#f7f7f7;
				color:#aaa;
				padding:20px;
				cursor:pointer;
				font-family: 'Roboto Slab', serif;
				position:relative;
			}
			
			#addNewCircle .plusImage {
			    height: 34px;
			    width: 34px;
			    background-size: contain;
			    background-repeat: no-repeat;
			    background-position: center;
			    display: inline-block;
			    opacity: .4;
			    position: absolute;
			    right: 20px;
			    top: 16px;
			}
			
			@media screen and (max-width: 620px) {
				main button{
					width:100%;
				}
			}
		</style>
		<script>
			requireLogIn();
			
			var plantSpeciesList = ["Swamp cottonwood","Populus heterophylla","Plains cottonwood","Populus deltoides","Quaking aspen","Populus tremuloides","Black cottonwood","Populus balsamifera","Fremont cottonwood","Populus fremontii","Narrowleaf cottonwood","Populus angustifolia","Silver poplar","Populus alba","Lombardy poplar","Populus nigra","Mesquite spp.","Prosopis spp.","Honey mesquite","Prosopis glandulosa","Velvet mesquite","Prosopis velutina","Screwbean mesquite","Prosopis pubescens","Cherry and plum spp.","Prunus spp.","Pin cherry","Prunus pensylvanica","Black cherry","Prunus serotina","Chokecherry","Prunus virginiana","Peach","Prunus persica","Canada plum","Prunus nigra","American plum","Prunus americana","Bitter cherry","Prunus emarginata","Allegheny plum","Prunus alleghaniensis","Chickasaw plum","Prunus angustifolia","Sweet cherry","Prunus avium","Sour cherry","Prunus cerasus","European plum","Prunus domestica","Mahaleb cherry","Prunus mahaleb","Oak spp.","Quercus spp.","California live oak","Quercus agrifolia","White oak","Quercus alba","Arizona white oak","Quercus arizonica","Swamp white oak","Quercus bicolor","Canyon live oak","Quercus chrysolepis","Scarlet oak","Quercus coccinea","Blue oak","Quercus douglasii","Durand oak","Quercus sinuata","Northern pin oak","Quercus ellipsoidalis","Emory oak","Quercus emoryi","Engelmann oak","Quercus engelmannii","Southern red oak","Quercus falcata","Cherrybark oak","Quercus pagoda","Gambel oak","Quercus gambelii","Oregon white oak","Quercus garryana","Scrub oak","Quercus ilicifolia","Shingle oak","Quercus imbricaria","California black oak","Quercus kelloggii","Turkey oak","Quercus laevis","Laurel oak","Quercus laurifolia","California white oak","Quercus lobata","Overcup oak","Quercus lyrata","Bur oak","Quercus macrocarpa","Blackjack oak","Quercus marilandica","Swamp chestnut oak","Quercus michauxii","Chinkapin oak","Quercus muehlenbergii","Water oak","Quercus nigra","Texas red oak","Quercus texana","Mexican blue oak","Quercus oblongifolia","Pin oak","Quercus palustris","Willow oak","Quercus phellos","Bigtooth aspen","Populus grandidentata","Chestnut oak","Quercus prinus","Northern red oak","Quercus rubra","Shumard oak","Quercus shumardii","Post oak","Quercus stellata","Delta post oak","Quercus similis","Black oak","Quercus velutina","Live oak","Quercus virginiana","Interior live oak","Quercus wislizeni","Dwarf post oak","Quercus margarettiae","Dwarf live oak","Quercus minima","Bluejack oak","Quercus incana","Silverleaf oak","Quercus hypoleucoides","Oglethorpe oak","Quercus oglethorpensis","Dwarf chinkapin oak","Quercus prinoides","Gray oak","Quercus grisea","Netleaf oak","Quercus rugosa","Chisos oak","Quercus graciliformis","Sea torchwood","Amyris elemifera","Pond-apple","Annona glabra","Gumbo limbo","Bursera simaruba","Sheoak spp.","Casuarina spp.","Gray sheoak","Casuarina glauca","Belah","Casuarina lepidophloia","Camphortree","Cinnamomum camphora","Florida fiddlewood","Citharexylum fruticosum","Citrus spp.","Citrus spp.","Tietongue","Coccoloba diversifolia","Soldierwood","Colubrina elliptica","Largeleaf geigertree","Cordia sebestena","Carrotwood","Cupaniopsis anacardioides","Bluewood","Condalia hookeri","Blackbead ebony","Ebenopsis ebano","Great leucaene","Leucaena pulverulenta","Texas sophora","Sophora affinis","Red stopper","Eugenia rhombea","Butterbough","Exothea paniculata","Florida strangler fig","Ficus aurea","Wild banyantree","Ficus citrifolia","Beeftree","Guapira discolor","Manchineel","Hippomane mancinella","False tamarind","Lysiloma latisiliquum","Mango","Mangifera indica","Florida poisontree","Metopium toxiferum","Fishpoison tree","Piscidia piscipula","Octopus tree","Schefflera actinophylla","False mastic","Sideroxylon foetidissimum","White bully","Sideroxylon salicifolium","Paradisetree","Simarouba glauca","Java plum","Syzygium cumini","Tamarind","Tamarindus indica","Black locust","Robinia pseudoacacia","New mexico locust","Robinia neomexicana","Everglades palm","Acoelorraphe wrightii","Florida silver palm","Coccothrinax argentata","Coconut palm","Cocos nucifera","Royal palm spp.","Roystonea spp.","Mexican palmetto","Sabal mexicana","Cabbage palmetto","Sabal palmetto","Key thatch palm","Thrinax morrisii","Florida thatch palm","Thrinax radiata","Other palms","Family arecaceae not listed above","Western soapberry","Sapindus saponaria","Willow spp.","Salix spp.","Peachleaf willow","Salix amygdaloides","Black willow","Salix nigra","Bebb willow","Salix bebbiana","Bonpland willow","Salix bonplandiana","Coastal plain willow","Salix caroliniana","Balsam willow","Salix pyrifolia","White willow","Salix alba","Scouler's willow","Salix scouleriana","Weeping willow","Salix sepulcralis","Sassafras","Sassafras albidum","Mountain-ash spp.","Sorbus spp.","American mountain-ash","Sorbus americana","European mountain-ash","Sorbus aucuparia","Northern mountain-ash","Sorbus decora","West indian mahogany","Swietenia mahagoni","Basswood spp.","Tilia spp.","American basswood","Tilia americana","White basswood","Tilia americana","Carolina basswood","Tilia americana","Elm spp.","Ulmus spp.","Winged elm","Ulmus alata","American elm","Ulmus americana","Cedar elm","Ulmus crassifolia","Siberian elm","Ulmus pumila","Slippery elm","Ulmus rubra","September elm","Ulmus serotina","Rock elm","Ulmus thomasii","California-laurel","Umbellularia californica","Joshua tree","Yucca brevifolia","Black-mangrove","Avicennia germinans","Buttonwood-mangrove","Conocarpus erectus","White-mangrove","Laguncularia racemosa","American mangrove","Rhizophora mangle","Desert ironwood","Olneya tesota","Saltcedar","Tamarix spp.","Melaleuca","Melaleuca quinquenervia","Chinaberry","Melia azedarach","Chinese tallowtree","Triadica sebifera","Tungoil tree","Vernicia fordii","Smoketree","Cotinus obovatus","Russian-olive","Elaeagnus angustifolia","Washington hawthorn","Crataegus phaenopyrum","Fleshy hawthorn","Crataegus succulenta","Dwarf hawthorn","Crataegus uniflora","Berlandier ash","Fraxinus berlandieriana","Avocado","Persea americana","Graves oak","Quercus gravesii","Mexican white oak","Quercus polymorpha","Buckley oak","Quercus buckleyi","Lacey oak","Quercus laceyi","Anacahuita","Cordia boissieri","Fir spp.","Abies spp.","Pacific silver fir","Abies amabilis","Balsam fir","Abies balsamea","Santa lucia or bristlecone fir","Abies bracteata","White fir","Abies concolor","Fraser fir","Abies fraseri","Grand fir","Abies grandis","Corkbark fir","Abies lasiocarpa","Subalpine fir","Abies lasiocarpa","California red fir","Abies magnifica","Shasta red fir","Abies shastensis","Noble fir","Abies procera","White-cedar spp.","Chamaecyparis spp.","Port-orford-cedar","Chamaecyparis lawsoniana","Alaska yellow-cedar","Chamaecyparis nootkatensis","Atlantic white-cedar","Chamaecyparis thyoides","Cypress","Cupressus spp.","Arizona cypress","Cupressus arizonica","Modoc cypress","Cupressus bakeri","Tecate cypress","Cupressus forbesii","Monterey cypress","Cupressus macrocarpa","Sargent's cypress","Cupressus sargentii","Macnab's cypress","Cupressus macnabiana","Redcedar/juniper spp.","Juniperus spp.","Pinchot juniper","Juniperus pinchotii","Redberry juniper","Juniperus coahuilensis","Drooping juniper","Juniperus flaccida","Ashe juniper","Juniperus ashei","California juniper","Juniperus californica","Alligator juniper","Juniperus deppeana","Western juniper","Juniperus occidentalis","Utah juniper","Juniperus osteosperma","Rocky mountain juniper","Juniperus scopulorum","Southern redcedar","Juniperus virginiana","Eastern redcedar","Juniperus virginiana","Oneseed juniper","Juniperus monosperma","Larch spp.","Larix spp.","Tamarack (native)","Larix laricina","Subalpine larch","Larix lyallii","Western larch","Larix occidentalis","Incense-cedar","Calocedrus decurrens","Spruce spp.","Picea spp.","Norway spruce","Picea abies","Brewer spruce","Picea breweriana","Engelmann spruce","Picea engelmannii","White spruce","Picea glauca","Black spruce","Picea mariana","Blue spruce","Picea pungens","Red spruce","Picea rubens","Sitka spruce","Picea sitchensis","Pine spp.","Pinus spp.","Whitebark pine","Pinus albicaulis","Bristlecone pine","Pinus aristata","Knobcone pine","Pinus attenuata","Foxtail pine","Pinus balfouriana","Jack pine","Pinus banksiana","Common pinyon","Pinus edulis","Sand pine","Pinus clausa","Lodgepole pine","Pinus contorta","Coulter pine","Pinus coulteri","Shortleaf pine","Pinus echinata","Slash pine","Pinus elliottii","Apache pine","Pinus engelmannii","Limber pine","Pinus flexilis","Southwestern white pine","Pinus strobiformis","Spruce pine","Pinus glabra","Jeffrey pine","Pinus jeffreyi","Sugar pine","Pinus lambertiana","Chihuahua pine","Pinus leiophylla","Western white pine","Pinus monticola","Bishop pine","Pinus muricata","Longleaf pine","Pinus palustris","Ponderosa pine","Pinus ponderosa","Table mountain pine","Pinus pungens","Monterey pine","Pinus radiata","Red pine","Pinus resinosa","Pitch pine","Pinus rigida","Gray or california foothill pine","Pinus sabiniana","Pond pine","Pinus serotina","Eastern white pine","Pinus strobus","Scotch pine","Pinus sylvestris","Loblolly pine","Pinus taeda","Virginia pine","Pinus virginiana","Singleleaf pinyon","Pinus monophylla","Border pinyon","Pinus discolor","Arizona pine","Pinus arizonica","Austrian pine","Pinus nigra","Washoe pine","Pinus washoensis","Four-leaf or parry pinyon pine","Pinus quadrifolia","Torrey pine","Pinus torreyana","Mexican pinyon pine","Pinus cembroides","Papershell pinyon pine","Pinus remota","Great basin bristlecone pine","Pinus longaeva","Arizona pinyon pine","Pinus monophylla","Honduras pine","Pinus elliottii","Douglas-fir spp.","Pseudotsuga spp.","Bigcone douglas-fir","Pseudotsuga macrocarpa","Douglas-fir","Pseudotsuga menziesii","Redwood","Sequoia sempervirens","Giant sequoia","Sequoiadendron giganteum","Baldcypress spp.","Taxodium spp.","Baldcypress","Taxodium distichum","Pondcypress","Taxodium ascendens","Montezuma baldcypress","Taxodium mucronatum","Yew spp.","Taxus spp.","Pacific yew","Taxus brevifolia","Florida yew","Taxus floridana","Thuja spp.","Thuja spp.","Northern white-cedar","Thuja occidentalis","Western redcedar","Thuja plicata","Torreya spp.","Torreya spp.","California torreya (nutmeg)","Torreya californica","Florida torreya (nutmeg)","Torreya taxifolia","Hemlock spp.","Tsuga spp.","Eastern hemlock","Tsuga canadensis","Carolina hemlock","Tsuga caroliniana","Western hemlock","Tsuga heterophylla","Mountain hemlock","Tsuga mertensiana","Acacia spp.","Acacia spp.","Sweet acacia","Acacia farnesiana","Catclaw acacia","Acacia greggii","Maple spp.","Acer spp.","Florida maple","Acer barbatum","Bigleaf maple","Acer macrophyllum","Boxelder","Acer negundo","Black maple","Acer nigrum","Striped maple","Acer pensylvanicum","Red maple","Acer rubrum","Silver maple","Acer saccharinum","Sugar maple","Acer saccharum","Mountain maple","Acer spicatum","Norway maple","Acer platanoides","Rocky mountain maple","Acer glabrum","Bigtooth maple","Acer grandidentatum","Chalk maple","Acer leucoderme","Buckeye spp.","Aesculus spp.","Ohio buckeye","Aesculus glabra","Yellow buckeye","Aesculus flava","California buckeye","Aesculus californica","Texas buckeye","Aesculus glabra","Red buckeye","Aesculus pavia","Painted buckeye","Aesculus sylvatica","Ailanthus","Ailanthus altissima","Mimosa","Albizia julibrissin","Alder spp.","Alnus spp.","Red alder","Alnus rubra","White alder","Alnus rhombifolia","Arizona alder","Alnus oblongifolia","European alder","Alnus glutinosa","Serviceberry spp.","Amelanchier spp.","Common serviceberry","Amelanchier arborea","Roundleaf serviceberry","Amelanchier sanguinea","Madrone spp.","Arbutus spp.","Pacific madrone","Arbutus menziesii","Arizona madrone","Arbutus arizonica","Texas madrone","Arbutus xalapensis","Pawpaw","Asimina triloba","Birch spp.","Betula spp.","Yellow birch","Betula alleghaniensis","Sweet birch","Betula lenta","River birch","Betula nigra","Water birch","Betula occidentalis","Paper birch","Betula papyrifera","Virginia roundleaf birch","Betula uber","Northwestern paper birch","Betula x utahensis","Gray birch","Betula populifolia","Chittamwood","Sideroxylon lanuginosum","American hornbeam","Carpinus caroliniana","Hickory spp.","Carya spp.","Water hickory","Carya aquatica","Bitternut hickory","Carya cordiformis","Pignut hickory","Carya glabra","Pecan","Carya illinoinensis","Shellbark hickory","Carya laciniosa","Nutmeg hickory","Carya myristiciformis","Shagbark hickory","Carya ovata","Black hickory","Carya texana","Mockernut hickory","Carya alba","Sand hickory","Carya pallida","Scrub hickory","Carya floridana","Red hickory","Carya ovalis","Southern shagbark hickory","Carya carolinae-septentrionalis","Chestnut spp.","Castanea spp.","American chestnut","Castanea dentata","Allegheny chinkapin","Castanea pumila","Ozark chinkapin","Castanea pumila","Chinese chestnut","Castanea mollissima","Giant chinkapin","Chrysolepis chrysophylla","Catalpa spp.","Catalpa spp.","Southern catalpa","Catalpa bignonioides","Northern catalpa","Catalpa speciosa","Hackberry spp.","Celtis spp.","Sugarberry","Celtis laevigata","Hackberry","Celtis occidentalis","Netleaf hackberry","Celtis laevigata","Eastern redbud","Cercis canadensis","Curlleaf mountain-mahogany","Cercocarpus ledifolius","Yellowwood","Cladrastis kentukea","Dogwood spp.","Cornus spp.","Flowering dogwood","Cornus florida","Pacific dogwood","Cornus nuttallii","Hawthorn spp.","Crataegus spp.","Cockspur hawthorn","Crataegus crus-galli","Downy hawthorn","Crataegus mollis","Brainerd's hawthorn","Crataegus brainerdii","Pear hawthorn","Crataegus calpodendron","Fireberry hawthorn","Crataegus chrysocarpa","Broadleaf hawthorn","Crataegus dilatata","Fanleaf hawthorn","Crataegus flabellata","Oneseed hawthorn","Crataegus monogyna","Scarlet hawthorn","Crataegus pedicellata","Eucalyptus spp.","Eucalyptus spp.","Tasmanian bluegum","Eucalyptus globulus","River redgum","Eucalyptus camaldulensis","Grand eucalyptus","Eucalyptus grandis","Swampmahogany","Eucalyptus robusta","Persimmon spp.","Diospyros spp.","Common persimmon","Diospyros virginiana","Texas persimmon","Diospyros texana","Anacua knockaway","Ehretia anacua","American beech","Fagus grandifolia","Ash spp.","Fraxinus spp.","White ash","Fraxinus americana","Oregon ash","Fraxinus latifolia","Black ash","Fraxinus nigra","Green ash","Fraxinus pennsylvanica","Pumpkin ash","Fraxinus profunda","Blue ash","Fraxinus quadrangulata","Velvet ash","Fraxinus velutina","Carolina ash","Fraxinus caroliniana","Texas ash","Fraxinus texensis","Honeylocust spp.","Gleditsia spp.","Waterlocust","Gleditsia aquatica","Honeylocust","Gleditsia triacanthos","Loblolly-bay","Gordonia lasianthus","Ginkgo","Ginkgo biloba","Kentucky coffeetree","Gymnocladus dioicus","Silverbell spp.","Halesia spp.","Carolina silverbell","Halesia carolina","Two-wing silverbell","Halesia diptera","Little silverbell","Halesia parviflora","American holly","Ilex opaca","Walnut spp.","Juglans spp.","Butternut","Juglans cinerea","Black walnut","Juglans nigra","Northern california black walnut","Juglans hindsii","Southern california black walnut","Juglans californica","Texas walnut","Juglans microcarpa","Arizona walnut","Juglans major","Sweetgum","Liquidambar styraciflua","Yellow-poplar","Liriodendron tulipifera","Tanoak","Lithocarpus densiflorus","Osage-orange","Maclura pomifera","Magnolia spp.","Magnolia spp.","Cucumbertree","Magnolia acuminata","Southern magnolia","Magnolia grandiflora","Sweetbay","Magnolia virginiana","Bigleaf magnolia","Magnolia macrophylla","Mountain or fraser magnolia","Magnolia fraseri","Pyramid magnolia","Magnolia pyramidata","Umbrella magnolia","Magnolia tripetala","Apple spp.","Malus spp.","Oregon crab apple","Malus fusca","Southern crab apple","Malus angustifolia","Sweet crab apple","Malus coronaria","Prairie crab apple","Malus ioensis","Mulberry spp.","Morus spp.","White mulberry","Morus alba","Red mulberry","Morus rubra","Texas mulberry","Morus microphylla","Black mulberry","Morus nigra","Tupelo spp.","Nyssa spp.","Water tupelo","Nyssa aquatica","Ogeechee tupelo","Nyssa ogeche","Blackgum","Nyssa sylvatica","Swamp tupelo","Nyssa biflora","Eastern hophornbeam","Ostrya virginiana","Sourwood","Oxydendrum arboreum","Paulownia empress-tree","Paulownia tomentosa","Bay spp.","Persea spp.","Redbay","Persea borbonia","Water-elm planertree","Planera aquatica","Sycamore spp.","Platanus spp.","California sycamore","Platanus racemosa","American sycamore","Platanus occidentalis","Arizona sycamore","Platanus wrightii","Cottonwood and poplar spp.","Populus spp.","Balsam poplar","Populus balsamifera","Eastern cottonwood","Populus deltoides"];
			
			$(document).ready(function(){
				loadBackgroundImage($("#splashImage"), "../images/splash.png");
				loadCircles();
			});
			$(window).resize(function(){
				$('.ui-autocomplete').css({display:"none"});
			});
			
			function inArrayIgnoreCaseAndWhitespace(needle, haystack){
				for(var i = 0; i < haystack.length; i++){
					if(haystack[i].replace(/\s\s+/g, ' ').trim().toLowerCase() == needle.replace(/\s\s+/g, ' ').trim().toLowerCase()){return true;}
				}
				return false;
			}
			
			function getWordAtIndex(str, index){
				var left = str.slice(0, index + 1).search(/\S+$/);
				var right = str.slice(index).search(/\s/);
				if (right < 0) {return str.slice(left);}
				return str.slice(left, right + index);
			}
			function attachAutoCompleteToInput(inputElement, sourceList){
				$(inputElement).autocomplete({
					minLength: 2,
					source: function(request, response) {
						var results = $.ui.autocomplete.filter(sourceList, request.term);
						results.sort(function(a, b){
							a = a.toLowerCase();
							b = b.toLowerCase();
							var term = request.term.toLowerCase();
							
							//how close to the beginning of a word
							var aWord = getWordAtIndex(a, a.indexOf(term));
							var bWord = getWordAtIndex(b, b.indexOf(term));
							var diff = aWord.indexOf(term) - bWord.indexOf(term);
							if(diff !== 0) return diff;
							
							//tiebreaker prioritize first word results
							var aFirstWord = a.split(" ").indexOf(aWord) == 0;
							var bFirstWord = b.split(" ").indexOf(bWord) == 0;
							if(aFirstWord && !bFirstWord) return -1;
							else if(bFirstWord && !aFirstWord) return 1;
							
							//tiebreaker is how close to the beginning of the string
							//var diff = a.indexOf(term) - b.indexOf(term);
							//if(diff !== 0){return diff;}
							
							//tiebreaker alphabetical
							if(a < b) return -1;
    						if(a > b) return 1;
    						return 0;
						});
						response(results);
						//response(results.slice(0, 10));
					},
					open: function(event, ui) {
						var idNumber = ($("input").index(this) + 1);
						$('#ui-id-' + idNumber).off('menufocus hover mouseover mouseenter');
						
            					var left = $('#ui-id-' + idNumber).position().left;
						var leftOffset = 0;
						if($(window).width() < 771){
							leftOffset = 45;
						}
						else if($(window).width() < 1000){
							leftOffset = 125;
						}
        					$('#ui-id-' + idNumber).css({left: (left - leftOffset) + "px"});
					}
				});
			}
			
			function loadCircles(){
				var xhttp = new XMLHttpRequest();
				xhttp.onreadystatechange = function() {
					if (this.readyState == 4 && this.status == 200) {
						if(this.responseText.indexOf("true|") == 0){
							var data = JSON.parse(this.responseText.replace("true|", ""));
							var siteName = data[0];
							var circles = data[1];
							
							$(".tagline").eq(0)[0].innerHTML = "in " + siteName;
							populateCircles(circles);
						}
						else{
							var error = this.responseText.replace("false|", "");
							
							$(".tagline").eq(0)[0].innerHTML = "Could not load.";
							$("#error")[0].onclick = function(){window.location = "../manageMySites";};
							$("#noticeInteractionBlock")[0].onclick = function(){window.location = "../manageMySites";};
							queueNotice("error", error);
							if(error == "Your log in dissolved. Maybe you logged in on another device."){
								logOut();
							}
						}
					}
				};
				xhttp.open("GET", "../php/getPlantsBySite.php?siteID=" + encodeURIComponent(window.location.toString().substring(window.location.toString().indexOf("?s=") + 3)) + "&email=" + encodeURIComponent(window.localStorage.getItem("email")) + "&salt=" + window.localStorage.getItem("salt"), true);
				xhttp.send();
			}
			
			function populateCircles(circles){
				//[[circle(int), [[orientation, code, plantSpecies]]]]
				//sort circles
				circles = circles.sort(function(a,b){return a[0] - b[0];});
				
				var htmlToAdd = "";
				for(var i = 0; i < circles.length; i++){
					htmlToAdd += getCircleHTML(circles[i]);
				}
				$("#circles")[0].innerHTML = htmlToAdd;
				$("#addNewCircle")[0].style.display = "block";
				if(circles.length > 0){
					$("#saveAllButton")[0].style.display = "block";
					attachAutoCompleteToInput($("input"), plantSpeciesList);
				}
			}
			
			function getCircleHTML(circle){
				if(circle.length != 2){return "";}
				for(var i = 0; i < circle[1].length; i++){
					if(circle[1][i].length != 3){return "";}
				}
				
				//sort plants
				var plants = circle[1].sort(function(a,b){
					if(a[0] < b[0]){return -1;}
					if(a[0] > b[0]){return 1;}
					return 0;
				});
				var noticeImage = "<img src=\"../images/notice.png\" class=\"noticeImage\" style=\"display:none;\"/>";
				for(var j = 0; j < plants.length; j++){
					if(plants[j][2].trim().toUpperCase() == "N/A"){
						noticeImage = "<img src=\"../images/notice.png\" class=\"noticeImage\"/>";
						break;
					}
				}
				var htmlToAdd = "<div class=\"circle\">";
				htmlToAdd += 	"<div class=\"circleTitle\" onclick=\"togglePlants(this.parentNode);\">Circle " + circle[0] + noticeImage + "</div>";
				htmlToAdd += 	"<div class=\"plants\">";
				for(var j = 0; j < plants.length; j++){
					var noticeBorder = "";
					if(plants[j][2].trim().toUpperCase() == "N/A"){
						noticeBorder = " style=\"border-right:5px solid #FF645A;\"";
					}
					htmlToAdd += "<div class=\"plant\">";
					htmlToAdd += 	"<div class=\"code\"><img src='../images/tag" + (j + 1) + ".png'/>" + plants[j][1] + "</div>";
					htmlToAdd += 	"<div class=\"editableFields\">";
					htmlToAdd += 		"<div class=\"editableFieldTitle\">Plant Species:</div>";
					htmlToAdd += 		"<input type=\"text\" id=\"" + plants[j][1] + "\" value=\"" + plants[j][2] + "\"" + noticeBorder + " onfocus=\"this.setSelectionRange(0, 9999);setNoticeExemptingInput(this.parentNode.parentNode.parentNode.parentNode, this);\" onblur=\"if(this.value.trim().toUpperCase() == 'N/A' || this.value.replace(/ /g, '') == ''){this.value = 'N/A';setNoticeImage(this.parentNode.parentNode.parentNode.parentNode);}else if(inArrayIgnoreCaseAndWhitespace(this.value, plantSpeciesList)){setNoticeImage(this.parentNode.parentNode.parentNode.parentNode);}else{promptConfirm('&quot;' + this.value + '&quot; is not in our records. Have you searched for other labels? Are you sure this is the correct name and spelling of your tree species?', 'Try again.', 'Continue. I am sure!', function(){document.getElementById('" + plants[j][1] + "').focus();}, function(){setNoticeImage(document.getElementById('" + plants[j][1] + "').parentNode.parentNode.parentNode.parentNode);});}\"/>";
					if(window.localStorage.getItem("email") == "plocharczykweb@gmail.com"){
						htmlToAdd += 		"<div class=\"editableFieldTitle\">Location change:</div>";
						htmlToAdd +=		"<table class=\"checkboxTable\">";
						htmlToAdd +=			"<tr onclick=\"toggleCheckbox($(this).find('.checkbox'));\">";
						htmlToAdd +=				"<td><div class=\"checkbox\" id=\"publicCheckbox\"></div></td>";
						htmlToAdd +=				"<td>The tree that currently has this code is no longer suitable for surveys, so I am moving this code to now identify a different tree.</td>";
						htmlToAdd +=				"<td onclick=\"event.stopPropagation();queueNotice('alert', 'If a tag with this the code &quot;" + plants[j][1] + "&quot; is hanging on a tree that is dead or otherwise no longer suitable to collect surveys with, check this checkbox and move that tag to another nearby tree. If the tree is of a different species than the unsuitable tree, go ahead and change the plant species as well. Make sure to click &quot;Save All&quot; before exiting the page.');\"><img src=\"../images/question.png\"/></td>";
						htmlToAdd +=			"<tr>";
						htmlToAdd +=		"</table>";
					}
					htmlToAdd += 	"</div>";
					htmlToAdd += "</div>";
				}
				htmlToAdd += 	"</div>";
				htmlToAdd += "</div>";
				return htmlToAdd;
			}
			
			function togglePlants(circle){
				var plants = $(circle).find(".plants").eq(0)[0];
				
				//reset all
				$(".circle").css({border:"2px solid #eee"});
				$(".plants").stop().animate({maxHeight:"0px"});
				$(".circleTitle").stop().animate({backgroundColor:"#f7f7f7", color:"#aaa"});
				
				if(plants.style.maxHeight == "" || plants.style.maxHeight == "0px"){
					$(circle).css({border:"0px none transparent"});
					$(plants).stop().animate({maxHeight:"850px"});
					$(circle).find(".circleTitle").eq(0).stop().animate({backgroundColor:"#444", color:"#fff"});
				}
				else{
					$(plants).stop().animate({maxHeight:"0px"});
				}
			}
			
			function setNoticeImage(circle){
				var inputs = $(circle).find("input");
				
				var showNotice = false;
				for(var i = 0; i < inputs.length; i++){
					if(inputs.eq(i)[0].value.trim().toUpperCase() == "N/A"){
						showNotice = true;
						inputs.eq(i)[0].style.borderRight = "5px solid #FF645A";
					}
					else{
						inputs.eq(i)[0].style.borderRight = "";
					}
				}
				
				if(showNotice){
					$(circle).find(".noticeImage").eq(0)[0].style.display = "block";
				}
				else{
					$(circle).find(".noticeImage").eq(0)[0].style.display = "none";
				}
			}
			
			function setNoticeExemptingInput(circle, exemptInput){
				var inputs = $(circle).find("input");
				
				var showNotice = false;
				for(var i = 0; i < inputs.length; i++){
					if(inputs.eq(i)[0] != $(exemptInput)[0] && inputs.eq(i)[0].value.trim().toUpperCase() == "N/A"){
						showNotice = true;
						inputs.eq(i)[0].style.borderRight = "5px solid #FF645A";
					}
					else{
						inputs.eq(i)[0].style.borderRight = "";
					}
				}
				
				if(showNotice){
					$(circle).find(".noticeImage").eq(0)[0].style.display = "block";
				}
				else{
					$(circle).find(".noticeImage").eq(0)[0].style.display = "none";
				}
			}
			
			var saving = false;
			function saveAll(){
				if(saving){return false;}
				
				saving = true;
				setLoadingButton($("#saveAllButton")[0], "Save all", true);
				
				var plantData = [];
				var inputs = $("input");
				for(var i = 0; i < inputs.length; i++){
					plantData[plantData.length] = [inputs.eq(i)[0].id, encodeURIComponent(inputs.eq(i)[0].value.replace(/\s\s+/g, ' '))];
				}
				
				var formData = new FormData();
				formData.append("plantData", JSON.stringify(plantData));
				formData.append("email", window.localStorage.getItem("email"));
				formData.append("salt", window.localStorage.getItem("salt"));
				$.ajax({
					url : "https://caterpillarscount.unc.edu/php/saveAllPlantSpecies.php",
					type : 'POST',
					data : formData,
					processData: false,  // tell jQuery not to process the data
					contentType: false,  // tell jQuery not to set contentType
					success : function(data) {
						if(data.indexOf("true|") == "0"){
							queueNotice("confirmation", "Saved!");
							$("#confirmation")[0].onclick = function(){window.location = "../manageMySites";};
							$("#noticeInteractionBlock")[0].onclick = function(){window.location = "../manageMySites";};
						}
						else{
							var savingError = data.replace("false|", "");
							queueNotice("error", savingError);
							if(savingError == "Your log in dissolved. Maybe you logged in on another device."){
								logOut();
							}
						}
					},
					error : function(request, status, error){
						queueNotice("error", request.responseText);
					},
					complete: function() {
						saving = false;
						setLoadingButton($("#saveAllButton")[0], "Save all", false);
						$('html, body').animate({ scrollTop: document.getElementById("splashImage").clientHeight }, 'slow');
					}
				});
			}
			
			var adding = false;
			function addNewCircle(){
				if(adding){return false;}
				
				adding = true;
				$("#addNewCircle")[0].innerHTML = "Adding New Circle...";
				//setLoadingButton($("#saveAllButton")[0], "Save all", true);
				
				var samplePlantCode = "";
				if($("input").length > 0){
					samplePlantCode = $("input").eq(0)[0].id;
				}
				
				var xhttp = new XMLHttpRequest();
				xhttp.onreadystatechange = function() {
					if (this.readyState == 4 && this.status == 200) {
						adding = false;
						$("#addNewCircle")[0].innerHTML = "Add New Circle<div class=\"plusImage\" style=\"background-image:url('../images/plus.png');\"></div>";
						//setLoadingButton($("#saveAllButton")[0], "Save all", false);
						if(this.responseText.indexOf("true|") == "0"){
							var newPlants = JSON.parse(this.responseText.replace("true|", ""));
							$("#circles").append(getCircleHTML([($(".circle").length + 1), newPlants]));
							attachAutoCompleteToInput($(".circle").eq($(".circle").length - 1).find("input"), plantSpeciesList);
						}
						else{
							$('html, body').animate({ scrollTop: document.getElementById("splashImage").clientHeight }, 'slow');
							var addingError = this.responseText.replace("false|", "");
							queueNotice("error", addingError);
							if(addingError == "Your log in dissolved. Maybe you logged in on another device."){
								logOut();
							}
						}
					}
				};
				xhttp.open("GET", "../php/addCircle.php?samplePlantCode=" + encodeURIComponent(samplePlantCode) + "&email=" + encodeURIComponent(window.localStorage.getItem("email")) + "&salt=" + window.localStorage.getItem("salt"), true);
				xhttp.send();
			}
		</script>
	</head>
	<body>
		<div id="managerRequest">
			<div id="managerRequestMessage"></div>
			<div id="managerRequestButtons">
				<div class="managerRequestButton" onclick="hideNotice();respondToManagerRequest('deny');">Deny</div>
				<div class="managerRequestButton" onclick="hideNotice();respondToManagerRequest('approve');">Accept</div>
			</div>
		</div>
		<div id="error" onclick="hideNotice();"></div>
		<div id="confirmation" onclick="hideNotice();"></div>
		<div id="alert" onclick="hideNotice();"></div>
		<div id="promptInteractionBlock"></div>
		<div id="noticeInteractionBlock" onclick="hideNotice();"></div>
		<div id="confirm">
			<div></div>
			<div>
				<button>OK</button>
				<button>Cancel</button>
				<div class="clearBoth"></div>
			</div>
		</div>
		
		<div id="splash">
			<div id="splashImage"></div>
			<div id="splashOverlay">
				<div id="splashIntroText">Welcome to</div>
				<div id="splashMainText">Caterpillars Count!</div>
				<button id="splashButton" onclick="this.blur();scrollToPanel(1);">Edit Survey Plants</button>
			</div>
		</div>
		<header>
			<h1><a href="../">Caterpillars Count!</a></h1>
			<div id="hamburger" onclick="toggleNav();">
				<div></div>
				<div></div>
				<div></div>
			</div>
			<div id="navKnockDown" class="clearBoth"></div>
			<nav class="loadingNav">
				<ul>
					<li onclick="accessSubMenu(this);">
						<span>Participate</span>
						<ul onclick="event.stopPropagation();">
							<li class="closeSubmenu" onclick="closeSubmenu(this.parentNode);"><img src="../images/arrow.png"/></li>
							<li><a href="../getStarted">Get Started</a></li>
							<li><a href="../conductASurvey">Conduct a Survey</a></li>
							<li><a href="../submitObservations">Submit Observations</a></li>
							<li><a href="../hostASurveySite">Host a Survey Site</a></li>
							<li><a href="../resources">Resources</a></li>
						</ul>
					</li>
					<li onclick="accessSubMenu(this);">
						<span>Explore</span>
						<ul onclick="event.stopPropagation();">
							<li class="closeSubmenu" onclick="closeSubmenu(this.parentNode);"><img src="../images/arrow.png"/></li>
							<li><a href="../mapsAndGraphs">Maps & Graphs</a></li>
							<li><a href="../recentObservations">Recent Observations</a></li>
						</ul>
					</li>
					<li onclick="accessSubMenu(this);">
						<span>Learn</span>
						<ul onclick="event.stopPropagation();">
							<li class="closeSubmenu" onclick="closeSubmenu(this.parentNode);"><img src="../images/arrow.png"/></li>
							<li><a href="../identificationSkills">Identification Skills</a></li>
							<li><a href="../forEducators">For Educators</a></li>
							<li><a href="../faq">FAQ</a></li>
						</ul>
					</li>
					<li onclick="window.location = '../signIn';">
						<span>Sign In</span>
						<ul onclick="event.stopPropagation();">
							<li class="closeSubmenu" onclick="closeSubmenu(this.parentNode);"><img src="../images/arrow.png"/></li>
							<li><a href="../createNewSite">Create New Site</a></li>
							<li><a href="../manageMySites">Manage My Sites</a></li>
							<li><a href="../settings">Settings</a></li>
							<li><a href="" onclick="logOut();">Sign Out</a></li>
						</ul>
					</li>
				</ul>
			</nav>
			<div id="navBack" onclick="resetMenu(false);">&#10094;</div>
		</header>
		<main>
			<div class="panel">
				<h2>Edit Survey Plants</h2>
				<div class="tagline">This site's plants are loading. Please wait a moment.</div>
				<div class="content">
					<div id="circles"></div>
					<div id="addNewCircle" onclick="promptConfirm('You cannot remove a circle once it has been created. Are you sure you want to add a new circle?', 'Nevermind.', 'Yes, I am sure!', function(){}, addNewCircle);">
						Add New Circle
						<div class="plusImage" style="background-image:url('../images/plus.png');"></div>
					</div>
					<button id="saveAllButton" onclick="saveAll();">Save all</button>
					<div style="text-align:center;margin-bottom:20px;" class="underline"><a href="../manageMySites" style="color:#ccc;font-size:16px;font-family: 'Montserrat', 'Helvetica Neue', Helvetica, Arial, sans-serif;">Cancel</a></div>
				</div>
			</div>
		</main>
		<footer>
			<div>Part of the <a href="http://pheno-mismatch.org" target="_blank">Pheno Mismatch</a> project funded by the National Science Foundation</div>
			
			<div><img src="../images/unc.png"/></div><div>
				<a target="_blank" href="https://www.facebook.com/Caterpillars-Count-1854259101283140/"><img src="../images/facebook.png" alt="facebook"/></a><a target="_blank" href="https://twitter.com/CaterpillarsCt"><img src="../images/twitter.png" alt="twitter"/></a>
			</div>
			
			<div>Contact us: <a href="mailto:caterpillarscount@gmail.com">caterpillarscount@gmail.com</a></div>
		</footer>
	</body>
</html>
